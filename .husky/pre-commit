#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Make script stop on first error
set -e

echo "ğŸ” Running pre-commit checks..."

# Backend checks
echo "âš™ï¸ Running backend checks..."
cd backend || exit 1

echo "Running isort..."
isort . || { echo "âŒ isort failed"; exit 1; }

echo "Running black..."
black . || { echo "âŒ black failed"; exit 1; }

echo "Running flake8..."
flake8 . || { echo "âŒ flake8 failed"; exit 1; }

echo "Running mccabe..."
flake8 . --select=C901 || { echo "âŒ mccabe failed"; exit 1; }

echo "Running mypy..."
mypy . || { echo "âŒ mypy failed"; exit 1; }

# Return to root directory
cd ..

# Frontend checks
echo "âš™ï¸ Running frontend checks..."
cd frontend || exit 1

echo "Running eslint..."
npx eslint . || { echo "âŒ eslint failed"; exit 1; }

echo "Running prettier..."
npx prettier --check . || { echo "âŒ prettier failed"; exit 1; }

echo "Running typescript..."
npx tsc --noEmit || { echo "âŒ typescript failed"; exit 1; }

# Return to root directory
cd ..

echo "âœ… All checks passed!"